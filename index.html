<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #121212;
      --card: #1e1e1e;
      --input-bg: #2d2d2d;
      --primary: #00e676; /* –ó–µ–ª–µ–Ω—ã–π –Ω–µ–æ–Ω */
      --text: #ffffff;
      --text-sec: #b0b0b0;
    }
    
    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h2 { color: var(--primary); margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px; }

    /* –§–û–†–ú–ê –í–í–û–î–ê */
    .form-container {
      background: var(--card);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      width: 100%;
      max-width: 500px;
      margin-bottom: 30px;
    }

    label { display: block; margin-top: 15px; color: var(--text-sec); font-size: 0.9em; }
    
    input {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      background: var(--input-bg);
      border: 1px solid #444;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      box-sizing: border-box;
      outline: none;
      transition: 0.3s;
    }
    
    input:focus { border-color: var(--primary); }

    button {
      width: 100%;
      margin-top: 25px;
      padding: 14px;
      background: var(--primary);
      color: #000;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      text-transform: uppercase;
    }
    button:hover { opacity: 0.9; }
    button:disabled { background: #555; cursor: not-allowed; }

    /* –°–ü–ò–°–û–ö –ó–ê–ü–ò–°–ï–ô */
    .list-container {
      width: 100%;
      max-width: 800px;
    }

    .record-card {
      background: var(--card);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
      border-left: 4px solid var(--primary);
      display: flex;
      flex-direction: column;
      gap: 8px;
      position: relative;
    }

    .record-header {
      display: flex;
      justify-content: space-between;
      color: var(--text-sec);
      font-size: 0.85em;
    }

    .data-row {
      display: flex;
      flex-direction: column;
    }
    
    .data-label { font-size: 0.75em; color: var(--text-sec); margin-bottom: 2px; }
    
    .clickable {
      cursor: pointer;
      padding: 4px 8px;
      background: #2a2a2a;
      border-radius: 4px;
      word-break: break-all;
      transition: 0.2s;
      border: 1px dashed #444;
    }

    .clickable:hover {
      background: #333;
      border-color: var(--primary);
      color: var(--primary);
    }
    
    .clickable:active { transform: scale(0.98); }

    .earnings {
      font-weight: bold;
      color: #ffd700; /* –ó–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –¥–ª—è –¥–µ–Ω–µ–≥ */
      font-size: 1.1em;
    }

    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ */
    #toast {
      visibility: hidden;
      min-width: 250px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 2px;
      padding: 16px;
      position: fixed;
      z-index: 1;
      bottom: 30px;
      font-size: 17px;
    }
    #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
    
    @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
    @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

    .loader { text-align: center; color: var(--text-sec); margin-top: 20px; }
  </style>
</head>
<body>

  <h2>–ü–∞–Ω–µ–ª—å –û–ø–µ—Ä–∞—Ç–æ—Ä–∞</h2>

  <div class="form-container">
    <form id="dataForm" onsubmit="handleFormSubmit(this)">
      
      <label>–ê–¥—Ä–µ—Å (Address)</label>
      <input type="text" name="address" placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å..." required>

      <label>–°—Å—ã–ª–∫–∞ (Link)</label>
      <input type="text" name="link" placeholder="https://..." required>

      <label>–ó–∞—Ä–∞–±–æ—Ç–æ–∫ (Earnings)</label>
      <input type="text" name="earnings" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 50$" required>

      <button type="submit" id="btn-submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –î–æ–∫–ª–∞–¥</button>
    </form>
  </div>

  <div class="list-container">
    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏:</h3>
    <div id="recordsList">
      <div class="loader">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
    </div>
  </div>

  <div id="toast">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!</div>

  <script>
    // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    window.onload = function() {
      loadData();
    };

    function loadData() {
      google.script.run.withSuccessHandler(renderRecords).getData();
    }

    function handleFormSubmit(formObject) {
      event.preventDefault();
      const btn = document.getElementById('btn-submit');
      btn.disabled = true;
      btn.textContent = "–û—Ç–ø—Ä–∞–≤–∫–∞...";

      google.script.run.withSuccessHandler(function(data) {
        // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
        document.getElementById('dataForm').reset();
        btn.disabled = false;
        btn.textContent = "–û–¢–ü–†–ê–í–ò–¢–¨ –î–û–ö–õ–ê–î";
        renderRecords(data);
      }).addRecord(formObject);
    }

    function renderRecords(dataArray) {
      const list = document.getElementById('recordsList');
      list.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫

      if (!dataArray || dataArray.length === 0) {
        list.innerHTML = '<div class="loader">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
        return;
      }

      dataArray.forEach(row => {
        // row[0]=–î–∞—Ç–∞, row[1]=–ê–¥—Ä–µ—Å, row[2]=–°—Å—ã–ª–∫–∞, row[3]=–ó–∞—Ä–∞–±–æ—Ç–æ–∫
        const card = document.createElement('div');
        card.className = 'record-card';
        
        card.innerHTML = `
          <div class="record-header">
            <span>üìÖ ${row[0]}</span>
          </div>
          
          <div class="data-row">
            <span class="data-label">–ê–î–†–ï–° (–ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å):</span>
            <span class="clickable" onclick="copyToClipboard('${row[1]}')">${row[1]}</span>
          </div>

          <div class="data-row">
            <span class="data-label">–°–°–´–õ–ö–ê (–ù–∞–∂–º–∏ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å):</span>
            <span class="clickable" onclick="copyToClipboard('${row[2]}')">${row[2]}</span>
          </div>

          <div class="data-row">
            <span class="data-label">–ó–ê–†–ê–ë–û–¢–û–ö:</span>
            <span class="earnings">${row[3]}</span>
          </div>
        `;
        list.appendChild(card);
      });
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(function() {
        showToast();
      }, function(err) {
        console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
      });
    }

    function showToast() {
      const x = document.getElementById("toast");
      x.className = "show";
      setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
    }
  </script>
</body>
</html>